{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\39338\\\\salus\\\\salus-frontend\\\\src\\\\AIAssistant.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport API from './api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction AIAssistant({\n  userId\n}) {\n  _s();\n  const [userMessage, setUserMessage] = useState('');\n  const [conversation, setConversation] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [userProfile, setUserProfile] = useState(null);\n  const [userSymptoms, setUserSymptoms] = useState([]);\n  const [showIntro, setShowIntro] = useState(true);\n  const [suggestedQuestions, setSuggestedQuestions] = useState([\"Come posso alleviare il mal di testa?\", \"Quali sono i sintomi più comuni dell'influenza?\", \"Dovresti consultare un medico per mal di stomaco persistente?\", \"Come posso migliorare la qualità del sonno?\", \"Quali sono i benefici dell'esercizio fisico regolare?\"]);\n  const messagesEndRef = useRef(null);\n  const chatContainerRef = useRef(null);\n\n  // Messaggio di benvenuto\n  const welcomeMessage = {\n    id: 'welcome',\n    text: 'Ciao! Sono Salus, il tuo assistente personale per la salute. Posso aiutarti a monitorare i tuoi sintomi, rispondere a domande mediche generali, e fornirti informazioni sui tuoi dati di salute. Come posso aiutarti oggi?',\n    isAI: true\n  };\n\n  // Carica i dati dell'utente all'avvio\n  useEffect(() => {\n    if (userId) {\n      fetchUserData();\n      fetchUserSymptoms();\n\n      // Carica la conversazione precedente dal localStorage\n      const savedConversation = localStorage.getItem(`aiConversation_${userId}`);\n      if (savedConversation) {\n        try {\n          setConversation(JSON.parse(savedConversation));\n          setShowIntro(false);\n        } catch (e) {\n          console.error('Errore nel parsing della conversazione salvata:', e);\n        }\n      }\n    }\n  }, [userId]);\n\n  // Salva la conversazione nel localStorage quando cambia\n  useEffect(() => {\n    if (userId && conversation.length > 0) {\n      localStorage.setItem(`aiConversation_${userId}`, JSON.stringify(conversation));\n    }\n  }, [conversation, userId]);\n\n  // Scroll automatico alla fine della conversazione\n  useEffect(() => {\n    scrollToBottom();\n  }, [conversation, isLoading]);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  const fetchUserData = async () => {\n    try {\n      const response = await API.get(`/auth/users/${userId}`);\n      setUserProfile(response.data);\n    } catch (error) {\n      console.error('Errore nel caricamento del profilo:', error);\n      showErrorToast('Impossibile caricare il profilo utente');\n    }\n  };\n  const fetchUserSymptoms = async () => {\n    try {\n      const response = await API.get(`/symptoms/${userId}`);\n      setUserSymptoms(response.data);\n\n      // Genera domande suggerite in base ai sintomi\n      if (response.data.length > 0) {\n        generateSuggestedQuestions(response.data);\n      }\n    } catch (error) {\n      console.error('Errore nel caricamento dei sintomi:', error);\n      showErrorToast('Impossibile caricare i sintomi');\n    }\n  };\n  const generateSuggestedQuestions = symptoms => {\n    if (symptoms.length === 0) return;\n\n    // Prendi i sintomi più recenti\n    const recentSymptoms = symptoms.slice(0, 3);\n\n    // Genera domande personalizzate\n    const customQuestions = recentSymptoms.map(symptom => `Come posso gestire il mio ${symptom.description.toLowerCase()}?`);\n\n    // Aggiungi domande generali\n    const generalQuestions = [\"Quali sono i pattern nei miei sintomi?\", \"Dovrei essere preoccupato per questi sintomi?\", \"Cosa posso fare per migliorare il mio benessere generale?\"];\n    setSuggestedQuestions([...customQuestions, ...generalQuestions].slice(0, 5));\n  };\n  const handleSuggestedQuestionClick = question => {\n    setUserMessage(question);\n    sendMessageToAI(question);\n  };\n  const sendMessageToAI = async (messageToSend = null) => {\n    const messageText = messageToSend || userMessage;\n    if (!messageText.trim() && !isLoading) return;\n\n    // Aggiungi il messaggio utente alla conversazione\n    const newUserMessage = {\n      role: 'user',\n      content: messageText\n    };\n    const updatedConversation = [...conversation, newUserMessage];\n    setConversation(updatedConversation);\n    if (!messageToSend) setUserMessage('');\n    setShowIntro(false);\n\n    // Prepara il contesto per OpenAI\n    setIsLoading(true);\n    try {\n      // Animazione di \"sta scrivendo\"\n      setTimeout(() => {\n        scrollToBottom();\n      }, 100);\n\n      // Versione semplificata della chiamata API\n      const response = await API.post('/ai/chat', {\n        message: newUserMessage.content\n      });\n\n      // Se c'è una risposta, aggiungila alla conversazione\n      if (response.data && response.data.reply) {\n        // Aggiungi la risposta alla conversazione\n        setConversation([...updatedConversation, {\n          role: 'assistant',\n          content: response.data.reply\n        }]);\n      } else {\n        throw new Error('Risposta AI non valida');\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('Errore nella chiamata AI:', error);\n      setConversation([...updatedConversation, {\n        role: 'assistant',\n        content: 'Mi dispiace, si è verificato un errore nella comunicazione. Riprova più tardi o controlla la tua connessione Internet.',\n        error: true\n      }]);\n      showErrorToast('Errore nella comunicazione con l\\'assistente: ' + (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message));\n    } finally {\n      setIsLoading(false);\n      setTimeout(() => {\n        scrollToBottom();\n      }, 100);\n    }\n  };\n\n  // Prepara il contesto con i dati dell'utente\n  const prepareContext = () => {\n    const recentSymptoms = userSymptoms.slice(0, 5);\n    return {\n      profile: userProfile,\n      recentSymptoms: recentSymptoms,\n      symptomSummary: summarizeSymptoms(userSymptoms)\n    };\n  };\n\n  // Crea un riepilogo dei sintomi\n  const summarizeSymptoms = symptoms => {\n    const symptomsGrouped = {};\n    symptoms.forEach(s => {\n      if (!symptomsGrouped[s.description]) {\n        symptomsGrouped[s.description] = [];\n      }\n      symptomsGrouped[s.description].push(s.intensity);\n    });\n    return Object.keys(symptomsGrouped).map(desc => ({\n      description: desc,\n      avgIntensity: calculateAverage(symptomsGrouped[desc]),\n      occurrences: symptomsGrouped[desc].length\n    }));\n  };\n  const calculateAverage = arr => {\n    return arr.reduce((a, b) => a + b, 0) / arr.length;\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessageToAI();\n    }\n  };\n  const useSuggestedQuestion = question => {\n    var _document$getElementB;\n    setUserMessage(question);\n    // Focus all'input\n    (_document$getElementB = document.getElementById('messageInput')) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.focus();\n  };\n  const showErrorToast = message => {\n    // Implementazione semplice di un toast di errore\n    const toast = document.createElement('div');\n    toast.className = 'error-toast';\n    toast.textContent = message;\n    document.body.appendChild(toast);\n    setTimeout(() => {\n      toast.classList.add('fade-out');\n      setTimeout(() => {\n        document.body.removeChild(toast);\n      }, 300);\n    }, 3000);\n  };\n  const clearConversation = () => {\n    if (window.confirm('Sei sicuro di voler cancellare tutta la conversazione?')) {\n      setConversation([]);\n      setShowIntro(true);\n      localStorage.removeItem(`aiConversation_${userId}`);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ai-assistant-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-header\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ai-identity\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/logo.svg\",\n          alt: \"Salus Logo\",\n          className: \"salus-logo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Salus\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-container\",\n      ref: chatContainerRef,\n      children: [showIntro && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"intro-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/logo.svg\",\n          alt: \"Salus Logo\",\n          className: \"salus-logo-large\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: welcomeMessage.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"suggested-questions\",\n          children: suggestedQuestions.map((question, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"suggested-question\",\n            onClick: () => handleSuggestedQuestionClick(question),\n            children: question\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages-container\",\n        children: [conversation.length === 0 && !showIntro && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message assistant-message\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-avatar\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/logo.svg\",\n              alt: \"Salus Logo\",\n              className: \"salus-avatar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-content\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: welcomeMessage.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 13\n        }, this), conversation.map((message, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${message.role === 'user' ? 'user-message' : 'assistant-message'}`,\n          children: [message.role === 'assistant' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-avatar\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/logo.svg\",\n              alt: \"Salus Logo\",\n              className: \"salus-avatar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `message-content ${message.error ? 'error' : ''}`,\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 15\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 13\n        }, this)), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message assistant-message\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-avatar\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/logo.svg\",\n              alt: \"Salus Logo\",\n              className: \"salus-avatar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-content\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"typing-indicator\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"powered-by\",\n      children: [\"Powered by \", /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"brand\",\n        children: \"OpenAI\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 20\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-bolt\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 58\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      jsx: true,\n      children: `\n        .ai-assistant-container {\n          padding: var(--space-2);\n        }\n        \n        .ai-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: var(--space-4);\n        }\n        \n        .ai-identity {\n          display: flex;\n          align-items: center;\n          gap: var(--space-2);\n        }\n        \n        .salus-logo {\n          width: 24px;\n          height: 24px;\n          margin-right: 8px;\n        }\n        \n        .salus-logo-large {\n          width: 80px;\n          height: 80px;\n          margin-bottom: 15px;\n        }\n        \n        .salus-logo-small {\n          width: 24px;\n          height: 24px;\n          margin-right: 10px;\n        }\n        \n        .chat-container {\n          display: flex;\n          flex-direction: column;\n          height: 60vh;\n          min-height: 400px;\n          border-radius: var(--radius-lg);\n          overflow: hidden;\n          background-color: var(--gray-100);\n          box-shadow: var(--shadow-md);\n          border: 1px solid var(--gray-200);\n        }\n        \n        .messages-container {\n          flex: 1;\n          overflow-y: auto;\n          padding: var(--space-4);\n          display: flex;\n          flex-direction: column;\n          gap: var(--space-3);\n        }\n        \n        .message {\n          display: flex;\n          max-width: 85%;\n          margin-bottom: var(--space-3);\n          animation: fadeIn 0.3s ease;\n        }\n        \n        .user-message {\n          margin-left: auto;\n          flex-direction: row-reverse;\n        }\n        \n        .assistant-message {\n          margin-right: auto;\n        }\n        \n        .message-avatar {\n          width: 36px;\n          height: 36px;\n          border-radius: 50%;\n          background-color: var(--primary-600);\n          color: white;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          margin-right: var(--space-2);\n        }\n        \n        .message-content {\n          background-color: var(--white);\n          padding: var(--space-3);\n          border-radius: var(--radius-lg);\n          box-shadow: var(--shadow-sm);\n          position: relative;\n        }\n        \n        .user-message .message-content {\n          background-color: var(--primary-600);\n          color: var(--white);\n          border-bottom-right-radius: var(--space-1);\n        }\n        \n        .assistant-message .message-content {\n          background-color: var(--white);\n          border-bottom-left-radius: var(--space-1);\n        }\n        \n        .message-error .message-content {\n          background-color: var(--danger);\n          color: var(--white);\n        }\n        \n        .message-text {\n          word-break: break-word;\n        }\n        \n        .message-time {\n          font-size: var(--font-size-xs);\n          color: var(--gray-500);\n          margin-top: var(--space-1);\n          text-align: right;\n        }\n        \n        .user-message .message-time {\n          color: rgba(255, 255, 255, 0.7);\n        }\n        \n        .message-typing {\n          opacity: 0.7;\n        }\n        \n        .typing-indicator {\n          display: flex;\n          align-items: center;\n          justify-content: flex-start;\n          gap: 5px;\n        }\n        \n        .typing-indicator span {\n          width: 8px;\n          height: 8px;\n          background-color: var(--gray-400);\n          border-radius: 50%;\n          display: inline-block;\n          animation: typing 1.4s infinite both;\n        }\n        \n        .typing-indicator span:nth-child(2) {\n          animation-delay: 0.2s;\n        }\n        \n        .typing-indicator span:nth-child(3) {\n          animation-delay: 0.4s;\n        }\n        \n        @keyframes typing {\n          0% { transform: scale(1); }\n          50% { transform: scale(1.5); }\n          100% { transform: scale(1); }\n        }\n        \n        .intro-container {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          padding: var(--space-4);\n          background-color: var(--white);\n          border-radius: var(--radius-lg);\n          margin-bottom: var(--space-3);\n          box-shadow: var(--shadow-md);\n        }\n        \n        .intro-container h3 {\n          margin-top: 0;\n          margin-bottom: var(--space-2);\n          color: var(--gray-900);\n        }\n        \n        .intro-container p {\n          margin: 0;\n          color: var(--gray-700);\n        }\n        \n        .powered-by {\n          text-align: center;\n          font-size: var(--font-size-xs);\n          color: var(--gray-500);\n          margin-top: var(--space-3);\n        }\n        \n        .brand {\n          font-weight: 600;\n          color: var(--gray-700);\n        }\n        \n        .error-toast {\n          position: fixed;\n          bottom: 20px;\n          right: 20px;\n          background-color: var(--danger);\n          color: white;\n          padding: var(--space-3) var(--space-4);\n          border-radius: var(--radius-md);\n          box-shadow: var(--shadow-md);\n          z-index: 1000;\n          animation: slideInUp 0.3s ease;\n        }\n        \n        .fade-out {\n          opacity: 0;\n          transition: opacity 0.3s ease;\n        }\n        \n        @media (max-width: 768px) {\n          .chat-container {\n            height: 70vh;\n          }\n          \n          .salus-logo {\n            width: 64px;\n            height: 64px;\n          }\n          \n          .salus-logo-large {\n            width: 120px;\n            height: 120px;\n          }\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 237,\n    columnNumber: 5\n  }, this);\n}\n_s(AIAssistant, \"T6eeNVEctIwUyK0FJ40VWw4+fkw=\");\n_c = AIAssistant;\nexport default AIAssistant;\nvar _c;\n$RefreshReg$(_c, \"AIAssistant\");","map":{"version":3,"names":["React","useState","useEffect","useRef","API","jsxDEV","_jsxDEV","AIAssistant","userId","_s","userMessage","setUserMessage","conversation","setConversation","isLoading","setIsLoading","userProfile","setUserProfile","userSymptoms","setUserSymptoms","showIntro","setShowIntro","suggestedQuestions","setSuggestedQuestions","messagesEndRef","chatContainerRef","welcomeMessage","id","text","isAI","fetchUserData","fetchUserSymptoms","savedConversation","localStorage","getItem","JSON","parse","e","console","error","length","setItem","stringify","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","response","get","data","showErrorToast","generateSuggestedQuestions","symptoms","recentSymptoms","slice","customQuestions","map","symptom","description","toLowerCase","generalQuestions","handleSuggestedQuestionClick","question","sendMessageToAI","messageToSend","messageText","trim","newUserMessage","role","content","updatedConversation","setTimeout","post","message","reply","Error","_error$response","_error$response$data","prepareContext","profile","symptomSummary","summarizeSymptoms","symptomsGrouped","forEach","s","push","intensity","Object","keys","desc","avgIntensity","calculateAverage","occurrences","arr","reduce","a","b","handleKeyPress","key","shiftKey","preventDefault","useSuggestedQuestion","_document$getElementB","document","getElementById","focus","toast","createElement","className","textContent","body","appendChild","classList","add","removeChild","clearConversation","window","confirm","removeItem","children","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","ref","index","onClick","jsx","_c","$RefreshReg$"],"sources":["C:/Users/39338/salus/salus-frontend/src/AIAssistant.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport API from './api';\n\nfunction AIAssistant({ userId }) {\n  const [userMessage, setUserMessage] = useState('');\n  const [conversation, setConversation] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [userProfile, setUserProfile] = useState(null);\n  const [userSymptoms, setUserSymptoms] = useState([]);\n  const [showIntro, setShowIntro] = useState(true);\n  const [suggestedQuestions, setSuggestedQuestions] = useState([\n    \"Come posso alleviare il mal di testa?\",\n    \"Quali sono i sintomi più comuni dell'influenza?\",\n    \"Dovresti consultare un medico per mal di stomaco persistente?\",\n    \"Come posso migliorare la qualità del sonno?\",\n    \"Quali sono i benefici dell'esercizio fisico regolare?\"\n  ]);\n  \n  const messagesEndRef = useRef(null);\n  const chatContainerRef = useRef(null);\n\n  // Messaggio di benvenuto\n  const welcomeMessage = {\n    id: 'welcome',\n    text: 'Ciao! Sono Salus, il tuo assistente personale per la salute. Posso aiutarti a monitorare i tuoi sintomi, rispondere a domande mediche generali, e fornirti informazioni sui tuoi dati di salute. Come posso aiutarti oggi?',\n    isAI: true\n  };\n\n  // Carica i dati dell'utente all'avvio\n  useEffect(() => {\n    if (userId) {\n      fetchUserData();\n      fetchUserSymptoms();\n      \n      // Carica la conversazione precedente dal localStorage\n      const savedConversation = localStorage.getItem(`aiConversation_${userId}`);\n      if (savedConversation) {\n        try {\n          setConversation(JSON.parse(savedConversation));\n          setShowIntro(false);\n        } catch (e) {\n          console.error('Errore nel parsing della conversazione salvata:', e);\n        }\n      }\n    }\n  }, [userId]);\n\n  // Salva la conversazione nel localStorage quando cambia\n  useEffect(() => {\n    if (userId && conversation.length > 0) {\n      localStorage.setItem(`aiConversation_${userId}`, JSON.stringify(conversation));\n    }\n  }, [conversation, userId]);\n\n  // Scroll automatico alla fine della conversazione\n  useEffect(() => {\n    scrollToBottom();\n  }, [conversation, isLoading]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const response = await API.get(`/auth/users/${userId}`);\n      setUserProfile(response.data);\n    } catch (error) {\n      console.error('Errore nel caricamento del profilo:', error);\n      showErrorToast('Impossibile caricare il profilo utente');\n    }\n  };\n\n  const fetchUserSymptoms = async () => {\n    try {\n      const response = await API.get(`/symptoms/${userId}`);\n      setUserSymptoms(response.data);\n      \n      // Genera domande suggerite in base ai sintomi\n      if (response.data.length > 0) {\n        generateSuggestedQuestions(response.data);\n      }\n    } catch (error) {\n      console.error('Errore nel caricamento dei sintomi:', error);\n      showErrorToast('Impossibile caricare i sintomi');\n    }\n  };\n\n  const generateSuggestedQuestions = (symptoms) => {\n    if (symptoms.length === 0) return;\n    \n    // Prendi i sintomi più recenti\n    const recentSymptoms = symptoms.slice(0, 3);\n    \n    // Genera domande personalizzate\n    const customQuestions = recentSymptoms.map(symptom => \n      `Come posso gestire il mio ${symptom.description.toLowerCase()}?`\n    );\n    \n    // Aggiungi domande generali\n    const generalQuestions = [\n      \"Quali sono i pattern nei miei sintomi?\",\n      \"Dovrei essere preoccupato per questi sintomi?\",\n      \"Cosa posso fare per migliorare il mio benessere generale?\"\n    ];\n    \n    setSuggestedQuestions([...customQuestions, ...generalQuestions].slice(0, 5));\n  };\n\n  const handleSuggestedQuestionClick = (question) => {\n    setUserMessage(question);\n    sendMessageToAI(question);\n  };\n\n  const sendMessageToAI = async (messageToSend = null) => {\n    const messageText = messageToSend || userMessage;\n    if (!messageText.trim() && !isLoading) return;\n    \n    // Aggiungi il messaggio utente alla conversazione\n    const newUserMessage = { role: 'user', content: messageText };\n    const updatedConversation = [...conversation, newUserMessage];\n    setConversation(updatedConversation);\n    if (!messageToSend) setUserMessage('');\n    setShowIntro(false);\n    \n    // Prepara il contesto per OpenAI\n    setIsLoading(true);\n    \n    try {\n      // Animazione di \"sta scrivendo\"\n      setTimeout(() => {\n        scrollToBottom();\n      }, 100);\n      \n      // Versione semplificata della chiamata API\n      const response = await API.post('/ai/chat', {\n        message: newUserMessage.content\n      });\n      \n      // Se c'è una risposta, aggiungila alla conversazione\n      if (response.data && response.data.reply) {\n        // Aggiungi la risposta alla conversazione\n        setConversation([\n          ...updatedConversation, \n          { role: 'assistant', content: response.data.reply }\n        ]);\n      } else {\n        throw new Error('Risposta AI non valida');\n      }\n    } catch (error) {\n      console.error('Errore nella chiamata AI:', error);\n      setConversation([\n        ...updatedConversation, \n        { \n          role: 'assistant', \n          content: 'Mi dispiace, si è verificato un errore nella comunicazione. Riprova più tardi o controlla la tua connessione Internet.',\n          error: true\n        }\n      ]);\n      showErrorToast('Errore nella comunicazione con l\\'assistente: ' + (error.response?.data?.message || error.message));\n    } finally {\n      setIsLoading(false);\n      setTimeout(() => {\n        scrollToBottom();\n      }, 100);\n    }\n  };\n  \n  // Prepara il contesto con i dati dell'utente\n  const prepareContext = () => {\n    const recentSymptoms = userSymptoms.slice(0, 5);\n    return {\n      profile: userProfile,\n      recentSymptoms: recentSymptoms,\n      symptomSummary: summarizeSymptoms(userSymptoms)\n    };\n  };\n  \n  // Crea un riepilogo dei sintomi\n  const summarizeSymptoms = (symptoms) => {\n    const symptomsGrouped = {};\n    symptoms.forEach(s => {\n      if (!symptomsGrouped[s.description]) {\n        symptomsGrouped[s.description] = [];\n      }\n      symptomsGrouped[s.description].push(s.intensity);\n    });\n    \n    return Object.keys(symptomsGrouped).map(desc => ({\n      description: desc,\n      avgIntensity: calculateAverage(symptomsGrouped[desc]),\n      occurrences: symptomsGrouped[desc].length\n    }));\n  };\n  \n  const calculateAverage = (arr) => {\n    return arr.reduce((a, b) => a + b, 0) / arr.length;\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessageToAI();\n    }\n  };\n  \n  const useSuggestedQuestion = (question) => {\n    setUserMessage(question);\n    // Focus all'input\n    document.getElementById('messageInput')?.focus();\n  };\n  \n  const showErrorToast = (message) => {\n    // Implementazione semplice di un toast di errore\n    const toast = document.createElement('div');\n    toast.className = 'error-toast';\n    toast.textContent = message;\n    document.body.appendChild(toast);\n    \n    setTimeout(() => {\n      toast.classList.add('fade-out');\n      setTimeout(() => {\n        document.body.removeChild(toast);\n      }, 300);\n    }, 3000);\n  };\n  \n  const clearConversation = () => {\n    if (window.confirm('Sei sicuro di voler cancellare tutta la conversazione?')) {\n      setConversation([]);\n      setShowIntro(true);\n      localStorage.removeItem(`aiConversation_${userId}`);\n    }\n  };\n\n  return (\n    <div className=\"ai-assistant-container\">\n      <div className=\"ai-header\">\n        <div className=\"ai-identity\">\n          <img src=\"/logo.svg\" alt=\"Salus Logo\" className=\"salus-logo\" />\n          <span>Salus</span>\n        </div>\n      </div>\n      \n      <div className=\"chat-container\" ref={chatContainerRef}>\n        {showIntro && (\n          <div className=\"intro-container\">\n            <img src=\"/logo.svg\" alt=\"Salus Logo\" className=\"salus-logo-large\" />\n            <h3>{welcomeMessage.text}</h3>\n            <div className=\"suggested-questions\">\n              {suggestedQuestions.map((question, index) => (\n                <button\n                  key={index}\n                  className=\"suggested-question\"\n                  onClick={() => handleSuggestedQuestionClick(question)}\n                >\n                  {question}\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n        \n        <div className=\"messages-container\">\n          {conversation.length === 0 && !showIntro && (\n            <div className=\"message assistant-message\">\n              <div className=\"message-avatar\">\n                <img src=\"/logo.svg\" alt=\"Salus Logo\" className=\"salus-avatar\" />\n              </div>\n              <div className=\"message-content\">\n                <p>{welcomeMessage.text}</p>\n              </div>\n            </div>\n          )}\n          \n          {conversation.map((message, index) => (\n            <div key={index} className={`message ${message.role === 'user' ? 'user-message' : 'assistant-message'}`}>\n              {message.role === 'assistant' && (\n                <div className=\"message-avatar\">\n                  <img src=\"/logo.svg\" alt=\"Salus Logo\" className=\"salus-avatar\" />\n                </div>\n              )}\n              <div className={`message-content ${message.error ? 'error' : ''}`}>\n                <p>{message.content}</p>\n              </div>\n            </div>\n          ))}\n          \n          {isLoading && (\n            <div className=\"message assistant-message\">\n              <div className=\"message-avatar\">\n                <img src=\"/logo.svg\" alt=\"Salus Logo\" className=\"salus-avatar\" />\n              </div>\n              <div className=\"message-content\">\n                <div className=\"typing-indicator\">\n                  <span></span>\n                  <span></span>\n                  <span></span>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      <div className=\"powered-by\">\n        Powered by <span className=\"brand\">OpenAI</span> <i className=\"fas fa-bolt\"></i>\n      </div>\n      \n      {/* Stili specifici del componente */}\n      <style jsx>{`\n        .ai-assistant-container {\n          padding: var(--space-2);\n        }\n        \n        .ai-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: var(--space-4);\n        }\n        \n        .ai-identity {\n          display: flex;\n          align-items: center;\n          gap: var(--space-2);\n        }\n        \n        .salus-logo {\n          width: 24px;\n          height: 24px;\n          margin-right: 8px;\n        }\n        \n        .salus-logo-large {\n          width: 80px;\n          height: 80px;\n          margin-bottom: 15px;\n        }\n        \n        .salus-logo-small {\n          width: 24px;\n          height: 24px;\n          margin-right: 10px;\n        }\n        \n        .chat-container {\n          display: flex;\n          flex-direction: column;\n          height: 60vh;\n          min-height: 400px;\n          border-radius: var(--radius-lg);\n          overflow: hidden;\n          background-color: var(--gray-100);\n          box-shadow: var(--shadow-md);\n          border: 1px solid var(--gray-200);\n        }\n        \n        .messages-container {\n          flex: 1;\n          overflow-y: auto;\n          padding: var(--space-4);\n          display: flex;\n          flex-direction: column;\n          gap: var(--space-3);\n        }\n        \n        .message {\n          display: flex;\n          max-width: 85%;\n          margin-bottom: var(--space-3);\n          animation: fadeIn 0.3s ease;\n        }\n        \n        .user-message {\n          margin-left: auto;\n          flex-direction: row-reverse;\n        }\n        \n        .assistant-message {\n          margin-right: auto;\n        }\n        \n        .message-avatar {\n          width: 36px;\n          height: 36px;\n          border-radius: 50%;\n          background-color: var(--primary-600);\n          color: white;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          margin-right: var(--space-2);\n        }\n        \n        .message-content {\n          background-color: var(--white);\n          padding: var(--space-3);\n          border-radius: var(--radius-lg);\n          box-shadow: var(--shadow-sm);\n          position: relative;\n        }\n        \n        .user-message .message-content {\n          background-color: var(--primary-600);\n          color: var(--white);\n          border-bottom-right-radius: var(--space-1);\n        }\n        \n        .assistant-message .message-content {\n          background-color: var(--white);\n          border-bottom-left-radius: var(--space-1);\n        }\n        \n        .message-error .message-content {\n          background-color: var(--danger);\n          color: var(--white);\n        }\n        \n        .message-text {\n          word-break: break-word;\n        }\n        \n        .message-time {\n          font-size: var(--font-size-xs);\n          color: var(--gray-500);\n          margin-top: var(--space-1);\n          text-align: right;\n        }\n        \n        .user-message .message-time {\n          color: rgba(255, 255, 255, 0.7);\n        }\n        \n        .message-typing {\n          opacity: 0.7;\n        }\n        \n        .typing-indicator {\n          display: flex;\n          align-items: center;\n          justify-content: flex-start;\n          gap: 5px;\n        }\n        \n        .typing-indicator span {\n          width: 8px;\n          height: 8px;\n          background-color: var(--gray-400);\n          border-radius: 50%;\n          display: inline-block;\n          animation: typing 1.4s infinite both;\n        }\n        \n        .typing-indicator span:nth-child(2) {\n          animation-delay: 0.2s;\n        }\n        \n        .typing-indicator span:nth-child(3) {\n          animation-delay: 0.4s;\n        }\n        \n        @keyframes typing {\n          0% { transform: scale(1); }\n          50% { transform: scale(1.5); }\n          100% { transform: scale(1); }\n        }\n        \n        .intro-container {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          padding: var(--space-4);\n          background-color: var(--white);\n          border-radius: var(--radius-lg);\n          margin-bottom: var(--space-3);\n          box-shadow: var(--shadow-md);\n        }\n        \n        .intro-container h3 {\n          margin-top: 0;\n          margin-bottom: var(--space-2);\n          color: var(--gray-900);\n        }\n        \n        .intro-container p {\n          margin: 0;\n          color: var(--gray-700);\n        }\n        \n        .powered-by {\n          text-align: center;\n          font-size: var(--font-size-xs);\n          color: var(--gray-500);\n          margin-top: var(--space-3);\n        }\n        \n        .brand {\n          font-weight: 600;\n          color: var(--gray-700);\n        }\n        \n        .error-toast {\n          position: fixed;\n          bottom: 20px;\n          right: 20px;\n          background-color: var(--danger);\n          color: white;\n          padding: var(--space-3) var(--space-4);\n          border-radius: var(--radius-md);\n          box-shadow: var(--shadow-md);\n          z-index: 1000;\n          animation: slideInUp 0.3s ease;\n        }\n        \n        .fade-out {\n          opacity: 0;\n          transition: opacity 0.3s ease;\n        }\n        \n        @media (max-width: 768px) {\n          .chat-container {\n            height: 70vh;\n          }\n          \n          .salus-logo {\n            width: 64px;\n            height: 64px;\n          }\n          \n          .salus-logo-large {\n            width: 120px;\n            height: 120px;\n          }\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default AIAssistant; "],"mappings":"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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IAAO;MAAAG,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACP,CAAC;AAEV;AAACrH,EAAA,CAvhBQF,WAAW;AAAA4H,EAAA,GAAX5H,WAAW;AAyhBpB,eAAeA,WAAW;AAAC,IAAA4H,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}